@import 'tailwindcss';
@import 'shepherd.js/dist/css/shepherd.css' layer(vendor);

/*
 * CSS Cascade Layer Order
 *
 * Layers are evaluated in declaration order - later layers win over earlier ones.
 * Tailwind v4 uses: theme, base, components, utilities.
 * We add: vendor (before, for third-party CSS) and overrides (after, for customizations).
 */
@layer vendor, theme, base, components, utilities, overrides;

/* Match Home page gradient so iOS safe area isn't white */
body {
  background-color: #eef2ff; /* indigo-50 */
}

@theme {
  --animate-radar-sweep: radar-sweep 0.6s linear forwards;
  --animate-radar-wedge: radar-wedge 0.6s linear forwards;
}

/* Radar sweep animation - smooth reveal using conic-gradient mask */
@property --sweep-angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@keyframes radar-sweep {
  /* Wait for wedge to grow (0-25%) */
  0% {
    --sweep-angle: 0deg;
  }
  25% {
    --sweep-angle: 0deg;
  }
  /* Track wedge trailing edge exactly */
  75% {
    --sweep-angle: 270deg;
  }
  100% {
    --sweep-angle: 360deg;
  }
}

.animate-radar-sweep {
  mask-image: conic-gradient(
    from 0deg at 50% 50%,
    black var(--sweep-angle),
    transparent var(--sweep-angle)
  );
  -webkit-mask-image: conic-gradient(
    from 0deg at 50% 50%,
    black var(--sweep-angle),
    transparent var(--sweep-angle)
  );
}

/* Radar wedge - grows from 0° to 90°, rotates, then shrinks */
@property --wedge-start {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@property --wedge-end {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@keyframes radar-wedge {
  /* Start: no wedge */
  0% {
    --wedge-start: 0deg;
    --wedge-end: 0deg;
  }
  /* Growth phase: wedge expands to 90° */
  25% {
    --wedge-start: 0deg;
    --wedge-end: 90deg;
  }
  /* Rotation phase complete: wedge at end position */
  75% {
    --wedge-start: 270deg;
    --wedge-end: 360deg;
  }
  /* Shrink: trailing edge catches up */
  100% {
    --wedge-start: 360deg;
    --wedge-end: 360deg;
  }
}

@layer base {
  body {
    @apply bg-white text-gray-900 antialiased;
  }
}

@layer utilities {
  /* Screen reader only - visually hidden but accessible */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }
}

/* Pulsing border animation for onboarding tour */
@keyframes pulse-border {
  0%,
  100% {
    border-color: rgb(199 210 254); /* indigo-200 */
  }
  50% {
    border-color: rgb(99 102 241); /* indigo-500 */
  }
}

.animate-pulse-border {
  border: 3px solid rgb(165 180 252); /* indigo-300 */
  border-radius: 0.5rem;
  animation: pulse-border 2s ease-in-out infinite;
}

/*
 * Shepherd.js tour customizations
 *
 * These styles override Shepherd's defaults to match our app's design system.
 * They're in the 'overrides' layer, which has higher priority than the 'vendor'
 * layer where shepherd.css is imported - no !important needed.
 */
@layer overrides {
  .shepherd-element {
    border-radius: 0.375rem; /* rounded-md */
    box-shadow:
      0 10px 15px -3px rgb(0 0 0 / 0.1),
      0 4px 6px -4px rgb(0 0 0 / 0.1); /* shadow-lg */
  }

  .shepherd-content {
    border-radius: 0.375rem;
  }

  .shepherd-text {
    padding: 1rem;
    font-size: 0.875rem; /* text-sm */
    line-height: 1.5rem;
    color: #374151; /* text-gray-700 */
  }

  .shepherd-header {
    padding: 0.75rem 1rem 0;
  }

  .shepherd-cancel-icon {
    color: #9ca3af; /* text-gray-400 */
    font-size: 1.5rem;
    font-weight: 400;
  }

  .shepherd-cancel-icon:hover {
    color: #6b7280; /* text-gray-500 */
  }

  .shepherd-footer {
    padding: 0.75rem 1rem 1rem;
    gap: 0.5rem;
  }

  /* Base button styles for all tour buttons */
  .shepherd-button {
    border-radius: 0.375rem;
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    font-weight: 500;
    transition:
      background-color 150ms,
      box-shadow 150ms;
  }

  /* Primary button (Next, Finish) */
  .shepherd-button:not(.shepherd-button-secondary):not(.shepherd-button-skip) {
    background-color: #4f46e5; /* bg-indigo-600 */
    color: white;
    border: none;
    box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  }

  .shepherd-button:not(.shepherd-button-secondary):not(.shepherd-button-skip):hover {
    background-color: #4338ca; /* bg-indigo-700 */
  }

  .shepherd-button:not(.shepherd-button-secondary):not(.shepherd-button-skip):focus {
    outline: none;
    box-shadow:
      0 0 0 2px white,
      0 0 0 4px #6366f1; /* ring-2 ring-indigo-500 ring-offset-2 */
  }

  /* Secondary button (Back) - white with border, fixed to left side */
  .shepherd-button-secondary {
    background-color: white;
    color: #374151; /* text-gray-700 */
    border: 1px solid #d1d5db; /* border-gray-300 */
    box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    margin-right: auto; /* Keep Back button on left even when Next is hidden */
  }

  .shepherd-button-secondary:hover {
    background-color: #f9fafb; /* bg-gray-50 */
  }

  .shepherd-button-secondary:focus {
    outline: none;
    box-shadow:
      0 0 0 2px white,
      0 0 0 4px #6366f1;
  }

  /* Hide the arrow pointing to target element */
  .shepherd-arrow {
    display: none;
  }
}
